<nav class="mbta--subnav">
  <div class="container mx-auto px-3">
    <a class="mbta--logo text-xl no-underline font-bold" href="/">{{ site.name }}</a>
    <button class="inline-flex justify-end px-2 py-1 md:hidden">
      Menu
    </button>
    
    <div class="hidden md:inline-flex gap-2 justify-center">
      {% set navPages = collections.all | eleventyNavigation %}
      {%- for entry in navPages %}
        <div class="relative"
          x-id="['dropdown-button']"
          x-data="{
              open: false,
              toggle() {
                  if (this.open) { return this.close() }
                  this.$refs.button.focus()
                  this.open = true
              },
              close(focusAfter) {
                  if (! this.open) return
                  this.open = false
                  focusAfter && focusAfter.focus()
              }
          }"
          x-on:keydown.escape.prevent.stop="close($refs.button)"
          x-on:focusin.window="! $refs.panel.contains($event.target) && close()">
          <button x-ref="button"
            x-on:click="toggle()"
            :aria-expanded="open"
            :aria-controls="$id('dropdown-button')"
            type="button"
            class="flex items-center gap-2 px-2 py-1 rounded-md" href="{{ entry.url }}">{{ entry.title }}
            {%- if entry.children.length -%}<i class="fa-solid fa-chevron-down"></i>{%- endif -%}
            </button>
          {%- if entry.children.length -%}
            <div class="absolute left-0 mt-1 min-w-28 rounded-md shadow-md grid grid-cols-1 divide-y"
              style="display: none;"
              x-ref="panel"
              x-show="open"
              x-transition.origin.top.left
              x-on:click.outside="close($refs.button)"
              :id="$id('dropdown-button')">
              {%- for child in entry.children %}
                <a class="px-2 py-1" href="{{child.url}}">{{child.title}}<a>
              {% endfor -%}
            </div>
          {%- endif -%}
          </div>
        {%- endfor -%}
      </div>
    </div>
  </nav>

  <nav class="mt-3">
    <div class="container mx-auto">
    {% set bPages = collections.all | eleventyNavigationBreadcrumb(eleventyNavigation.key, { includeSelf: true }) %}
    <div class="container mx-auto px-3">
    {%- for entry in bPages %}
      {%- if not loop.first %}
      <i class="fa-solid fa-chevron-right px-2"></i>
      {%- endif %}
      <a class="underline underline-offset-4 decoration-2 hover:decoration-4" href="{{ entry.url }}">{{ entry.title }}</a>
    {%- endfor -%}
    </div>
  </div>
</div>
